// Example starter JavaScript for disabling form submissions if there are invalid fields
(function () {
  'use strict'

  // Fetch all the forms we want to apply custom Bootstrap validation styles to
  var orgs = document.querySelectorAll('.org-form')
  var devs = document.querySelectorAll('.dev-form')

  const $btn1 = $('.contact-btn')

  // Loop over them and prevent submission
  Array.prototype.slice.call(orgs)
    .forEach(function (org) {
    org.addEventListener('submit', function (event) {
        
    $btn1.prop('disabled', true).html('<div class="spinner-border text-light spinner-border-sm" role="status"><span class="sr-only"></span></div>')
    // console.log("YES");
        if (!org.checkValidity()){
          event.preventDefault(),
          event.stopPropagation(),
          $btn1.prop('disabled', false).text('Apply')
        }
        else{
          event.preventDefault()
          const organisation = {
            type: 'org',
            comName : $('#validationCustom01').val(),
            email : $('#validationCustom02').val(),
            phone : $('#validationCustom03').val(),
            desOrg : $('#validationCustom04').val(),
            desServ : $('#validationCustom05').val()
          }
          console.log(organisation.type)
          $.ajax({
            url: './backend/pentest-mail.php',
            type: 'POST',
            data: organisation,
            dataType: "JSON",
            success: function (me) {
              if (me.res == "success") {
                console.log(me.res);
                $btn1.prop('disabled', true).text('Sent!').css({
                  'background':'green'
                })
                $('.reg-cover1').fadeIn('slow').css("display" , "flex");
                // $('.reg-cover2').fadeOut('fast').css("display" , "none");
              }else{
                console.log(me.res);
                $btn1.prop('disabled', false).text('Try again').css({
                  'background':'#D60000'
                })
              }
            }
          })
        }

      org.classList.add('was-validated')
    }, false)
  })

  const $btn2 = $('.contact-btn2')
  Array.prototype.slice.call(devs)
  .forEach(function (dev) {
    dev.addEventListener('submit', function (event) {
        
    $btn2.prop('disabled', true).html('<div class="spinner-border text-light spinner-border-sm" role="status"><span class="sr-only"></span></div>')
    // console.log("YES");
        if (!dev.checkValidity()){
          event.preventDefault(),
          event.stopPropagation(),
          $btn2.prop('disabled', false).text('Apply')
        }
        else{
          event.preventDefault()
          const developer = {
            type:"dev",
            name : $('#validationCustom06').val(),
            email : $('#validationCustom07').val(),
            phone : $('#validationCustom08').val(),
            desServ : $('#validationCustom09').val(),
          }
          $.ajax({
            url: './backend/pentest-mail.php',
            type: 'POST',
            data: developer,
            dataType: "JSON",
            success: function (me) {
              if (me.res == "success") {
                console.log(me.res);
                $btn2.prop('disabled', true).text('Sent!').css({
                  'background':'green'
                })
                // $('.reg-cover1').fadeOut('fast').css("display" , "none");
                $('.reg-cover2').fadeIn('slow').css("display" , "flex");
              }else{
                console.log(me.res);
                $btn2.prop('disabled', false).text('Try again').css({
                  'background':'#D60000'
                })
              }
            }
          })
          console.log(developer.type)
        }

      dev.classList.add('was-validated')
    }, false)
  })
  
})()


$(window).on('load', function () {
  $('.loader').fadeOut('slow');
})


$(document).ready(function () {

  $('.menu-icon').click(function () {
    $('.menu-bar-cont').slideToggle('show');
  });
  
  $('.org-button').click(function () {

    // BUTTON DISPLAY
    $('.org-button').css({
      backgroundColor : '#d60000',
      color : '#fff',
      fontSize : '17px',
      padding : '10px 7% 12px 7%',
      margin : '0 20px 0 0',
      border : 'none',
      borderRadius : '10px',
      transition : '.5 ease'
    })

    $('.dev-button').css({
      backgroundColor : 'transparent',
      color : '#d60000',
      fontSize : '17px',
      padding : '10px 7% 12px 7%',
      border : '1px solid #d60000',
      borderRadius : '10px',
      transition : '.5 ease'
    })

    // BUTTON DISPLAY END

    // FORM START

    $('.org-form').css("display", "block")
    $('.dev-form').css("display", "none")

      // FORM END
  })

  $('.dev-button').click(function () {

    // BUTTON DISPLAY
    $('.dev-button').css({
      backgroundColor : '#d60000',
      color : '#fff',
      fontSize : '17px',
      padding : '10px 7 12px 7%',
      border : 'none',
      borderRadius : '10px',
      transition : '.5s ease'
    })

    $('.org-button').css({
      backgroundColor : 'transparent',
      color : '#d60000',
      fontSize : '17px',
      padding : '10px 7% 12px 7%',
      border : '1px solid #d60000',
      borderRadius : '10px',
      transition : '.5s ease'
    })

    // BUTTON DISPLAY END

      // FORM START
      $('.org-form').css("display", "none")
      $('.dev-form').css("display", "block")
      // FORM END
  })

})